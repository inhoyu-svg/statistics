/* ===== 씬 스타일 ===== */
.math-scene {
    /* 기본값 - 내용 관련 한글 (의미, 예, 주의 등) */
    border: 3px solid #A2FF72;
    width: 100%;
    max-width: none;
    position: relative;
    margin-bottom: 0;
    transition: opacity 0.8s ease-out, visibility 0.8s ease-out;
    flex: none;
    box-sizing: border-box;
    white-space: nowrap;
    /* 초기 로드 시 모든 math-scene 숨김 */
    opacity: 0;
    visibility: hidden;
}

/* today-scene, number-scene, summary-scene을 제외한 모든 math-scene에 border-radius 적용 */
.math-scene:not(.today-scene):not(.number-scene):not(.summary-scene) {
    border-radius: clamp(15px, 1.25vw + 5px, 20px);
}

/* Today Scene tag를 가진 math-scene */
.math-scene.today-scene {
    border: 3px solid #A2FF72;
    padding: clamp(68px, 5.625vw + 22.5px, 90px) 0 clamp(68px, 5.625vw + 22.5px, 90px) 0;
}

/* Today Scene 녹색 테마 - width max-content로 복원 */
.math-scene.theme-green.today-scene {
    width: max-content;
}

/* 숫자 Scene tag를 가진 math-scene */
.math-scene.number-scene {
    border: 3px solid #A2FF72;
    border-radius: clamp(45px, 3.75vw + 15px, 60px);
}

/* 녹색 테마 math-scene */
.math-scene.theme-green {
    border-color: #A2FF72;
}

.math-scene.theme-green .scene-tag {
    background: #A2FF72;
    border-color: #A2FF72;
}

.math-scene.theme-green .scene-title {
    color: #A2FF72;
}

/* Today일 때 녹색 테마 */
.math-scene.theme-green.today-scene {
    border: 3px solid #A2FF72
}

/* 숫자일 때 녹색 테마 - summary 제외 */
.math-scene.theme-green.number-scene:not(.summary-scene) {
    border: 3px solid #A2FF72;
    border-radius: clamp(45px, 3.75vw + 15px, 60px);
}

/* 노란색 테마 math-scene */
.math-scene.theme-yellow {
    border-color: #FFD34F;
}

.math-scene.theme-yellow .scene-tag {
    background: #FFD34F;
    border-color: #FFD34F;
}

.math-scene.theme-yellow .scene-title {
    color: #FFD34F;
}

/* Today일 때 노란색 테마 */
.math-scene.theme-yellow.today-scene {
    border: 3px solid #FFD34F;
    border-radius: clamp(45px, 3.75vw + 15px, 60px);
}

/* 숫자일 때 노란색 테마 - summary 제외 */
.math-scene.theme-yellow.number-scene:not(.summary-scene) {
    border: 3px solid #FFD34F;
    border-radius: clamp(45px, 3.75vw + 15px, 60px);
}

/* 빨간색 테마 math-scene */
.math-scene.theme-red {
    border-color: #FF4F87;
}

.math-scene.theme-red .scene-tag {
    background: #FF4F87;
    border-color: #FF4F87;
}

.math-scene.theme-red .scene-title {
    color: #FF4F87;
}

/* Today일 때 빨간색 테마 */
.math-scene.theme-red.today-scene {
    border: 3px solid #FF4F87;
    border-radius: clamp(45px, 3.75vw + 15px, 60px);
}

/* 숫자일 때 빨간색 테마 - summary 제외 */
.math-scene.theme-red.number-scene:not(.summary-scene) {
    border: 3px solid #FF4F87;
    border-radius: clamp(45px, 3.75vw + 15px, 60px);
}

/* Summary Scene */
.math-scene.summary-scene {
    border-width: 3px;
    border-radius: 0;
}

/* Summary Scene이 pending-border-reveal 상태가 아닐 때만 border 색상 표시 */
.math-scene.summary-scene:not(.pending-border-reveal) {
    border-color: #DB6FE7;
}

.math-scene.summary-scene .scene-tag {
    background: #DB6FE7;
    border-color: #DB6FE7;
    font-size: clamp(32.3px, 2.65625vw + 10.625px, 42.5px);
    width: clamp(50.4px, 4.2vw + 16.8px, 67.2px);
    height: clamp(50.4px, 4.2vw + 16.8px, 67.2px);
    padding: 0;
    border-radius: 50%;
    box-shadow: 0 clamp(2.1px, 0.175vw + 0.7px, 2.8px) clamp(9.8px, 0.875vw + 3.5px, 14px) rgba(219, 111, 231, 0.3);
    top: clamp(-29px, -1.25vw - 19px, -34px);
}

.math-scene.summary-scene .scene-title {
    color: #DB6FE7;
    padding-top: clamp(55.5px, 4.6875vw + 18.75px, 75px);
    padding-left: clamp(62px, 4.375vw + 27.5px, 80px);
    padding-right: clamp(62px, 4.375vw + 27.5px, 80px);
    margin-bottom: clamp(33px, 2.8125vw + 11.25px, 45px);
}

/* Summary Frame의 main-title 보라색 적용 (chapter-badge에 summary 클래스가 있는 경우) */
.chalk-frame:has(.chapter-badge.summary) .main-title {
    color: #DB6FE7;
}

.chalk-frame:has(.chapter-badge.summary) .main-title .MathJax,
.chalk-frame:has(.chapter-badge.summary) .main-title .MathJax *,
.chalk-frame:has(.chapter-badge.summary) .main-title .math,
.chalk-frame:has(.chapter-badge.summary) .main-title .math * {
    color: #DB6FE7;
}

/* 미래 씬들 숨기기 */
.math-scene.future-scene {
    opacity: 0;
    visibility: hidden;
}

/* future-scene 클래스가 없으면 보이기 */
.math-scene:not(.future-scene) {
    opacity: 1;
    visibility: visible;
}

/* 미래 씬들의 테두리와 태그 숨기기 */
.math-scene.future-scene .scene-tag,
.math-scene.future-scene {
    border-color: transparent;
}

.math-scene.future-scene .scene-tag {
    background: transparent;
    color: transparent;
}

/* show-border-on-reveal 클래스를 가진 요소가 아직 reveal되지 않은 씬의 border 숨김 */
.math-scene.pending-border-reveal,
.math-scene.theme-green.pending-border-reveal,
.math-scene.theme-yellow.pending-border-reveal,
.math-scene.theme-red.pending-border-reveal,
.math-scene.theme-green.today-scene.pending-border-reveal,
.math-scene.theme-yellow.today-scene.pending-border-reveal,
.math-scene.theme-red.today-scene.pending-border-reveal,
.math-scene.theme-green.number-scene.pending-border-reveal,
.math-scene.theme-yellow.number-scene.pending-border-reveal,
.math-scene.theme-red.number-scene.pending-border-reveal,
.math-scene.summary-scene.pending-border-reveal,
.math-scene.review-scene.pending-border-reveal {
    border-color: transparent;
}

.math-scene.pending-border-reveal .scene-tag,
.math-scene.theme-green.pending-border-reveal .scene-tag,
.math-scene.theme-yellow.pending-border-reveal .scene-tag,
.math-scene.theme-red.pending-border-reveal .scene-tag,
.math-scene.summary-scene.pending-border-reveal .scene-tag,
.math-scene.review-scene.pending-border-reveal .scene-tag {
    border-color: transparent;
}

.scene-tag {
    position: absolute;
    top: clamp(-19px, -1.25vw - 9px, -24px);
    left: 50%;
    transform: translateX(-50%);
    text-align: center;
    font-family: 'SCDream';
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
    /* 기본값 - 2글자 텍스트 */
    background: #A2FF72;
    color: #000000;
    font-weight: 600;
    font-size: clamp(21px, 1.5625vw + 8.25px, 27px);
    padding: clamp(7px, 0.5625vw + 2.25px, 9px) clamp(18px, 1.5vw + 6px, 24px);
    border-radius: clamp(18px, 1.5vw + 6px, 24px);
    border: none;
    box-shadow: 0 clamp(1.5px, 0.125vw + 0.5px, 2px) clamp(7px, 0.625vw + 2.5px, 10px) rgba(162, 255, 114, 0.3);
    /* 초기 로드 시 숨김 */
    opacity: 0;
    visibility: hidden;
}

/* Today인 경우 */
.scene-tag.today {
    color: #000000;
    background: #A2FF72;
    border: none;
    font-size: clamp(23px, 1.75vw + 9px, 30px);
    font-weight: 700;
    padding: clamp(11px, 0.875vw + 3.5px, 14px) clamp(21px, 1.75vw + 7px, 28px);
    border-radius: clamp(7px, 0.625vw + 2.5px, 10px);
    top: clamp(-28px, -2vw - 12px, -36px);
}

/* todaySceneTag1 예외 처리 - 원래 위치 유지 */
#todaySceneTag1 {
    top: clamp(-26px, -2vw - 10px, -34px);
}

/* 2글자 텍스트인 경우 (의미, 주의, 증명 등) - 기본값이므로 별도 클래스 불필요 */

/* 한글자인 경우 (예) */
.scene-tag.single-char {
    color: #000000;
    background: #FFD34F;
    font-size: clamp(15px, 1.25vw + 5px, 20px);
    font-weight: 600;
    padding: 0;
    width: clamp(34px, 2.8125vw + 11.25px, 45px);
    height: clamp(34px, 2.8125vw + 11.25px, 45px);
    border-radius: 50%;
    border: none;
    top: clamp(-22px, -1.25vw - 12px, -27px);
}

/* 숫자인 경우 */
.scene-tag.number {
    color: #000000;
    background: #A2FF72;
    font-size: clamp(22px, 1.875vw + 7.5px, 30px);
    font-weight: 600;
    padding: 0;
    width: clamp(30px, 2.5vw + 10px, 40px);
    height: clamp(30px, 2.5vw + 10px, 40px);
    border-radius: 50%;
    border: none;
    z-index: 10;
}

/* Today와 Summary 태그는 JavaScript로 동적 스타일링 적용 */

.scene-title {
    color: #A2FF72;
    font-family: 'SCDream';
    font-weight: 500;
    font-size: clamp(34px, 2.8125vw + 11.25px, 45px);
    margin-bottom: clamp(22px, 1.875vw + 7.5px, 30px);
    padding: clamp(37px, 3.125vw + 12.5px, 50px) clamp(52px, 4.375vw + 17.5px, 70px) 0 clamp(52px, 4.375vw + 17.5px, 70px);
    text-align: center;
    white-space: nowrap;
}

.scene-title .MathJax,
.scene-title .MathJax *,
.scene-title .math,
.scene-title .math * {
    color: inherit;
}

.scene-subtitle {
    color: #ccc;
    font-family: 'SCDream';
    font-weight: 500;
    font-size: clamp(1.25rem, 2.5vw + 0.75rem, 1.5rem);
    margin-bottom: clamp(15px, 1.25vw + 5px, 20px);
    text-align: center;
}
