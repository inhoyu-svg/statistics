<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>산점도 시각화 케이스</title>
  <style>
    /* SCDream 폰트 로드 */
    @font-face {
      font-family: 'SCDream';
      src: url('../frame-test/frame-test/public/assets/fonts/SCDream/SCDream3.otf') format('opentype');
      font-weight: 300;
    }
    @font-face {
      font-family: 'SCDream';
      src: url('../frame-test/frame-test/public/assets/fonts/SCDream/SCDream5.otf') format('opentype');
      font-weight: 500;
    }

    :root {
      --bg-dark: #1a1a2e;
      --card-bg: #252540;
      --primary: #8DCF66;
      --secondary: #FFD93D;
      --text: #eee;
      --text-muted: #888;
      --btn-config: #4a4a6a;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 74px 30px 30px;
      background: var(--bg-dark);
      color: var(--text);
      font-family: 'SCDream', -apple-system, BlinkMacSystemFont, sans-serif;
      line-height: 1.6;
    }

    /* 상단 네비게이션 */
    .top-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 44px;
      background: #1a1a1e;
      border-bottom: 1px solid #3a3a42;
      display: flex;
      align-items: center;
      padding: 0 20px;
      z-index: 1000;
      gap: 16px;
    }
    .nav-home {
      color: #888;
      text-decoration: none;
      font-size: 13px;
      padding: 6px 12px;
      border-radius: 6px;
      transition: all 0.2s;
    }
    .nav-home:hover {
      color: #eee;
      background: rgba(255, 255, 255, 0.1);
    }
    .nav-title {
      color: #eee;
      font-size: 14px;
      font-weight: 500;
    }
    .nav-version {
      color: #666;
      font-size: 11px;
      margin-left: auto;
    }

    /* 헤더 */
    .page-header {
      text-align: center;
      margin-bottom: 40px;
    }
    .page-header h1 {
      margin: 0;
      font-size: 32px;
      color: var(--secondary);
      font-weight: 500;
    }
    .page-header .subtitle {
      margin: 10px 0 0;
      color: var(--text-muted);
      font-size: 14px;
    }

    /* 섹션 */
    .section {
      margin-bottom: 40px;
    }
    .section-title {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
      font-size: 18px;
      color: var(--text);
    }
    .section-title .icon {
      color: var(--primary);
    }

    /* 케이스 그리드 - 3열 고정 */
    .case-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 24px;
    }

    @media (max-width: 1200px) {
      .case-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 800px) {
      .case-grid {
        grid-template-columns: 1fr;
      }
    }

    /* 케이스 카드 */
    .case-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 20px;
      overflow: hidden;
    }
    .case-header h3 {
      margin: 0 0 5px;
      font-size: 15px;
      color: var(--secondary);
      font-weight: 500;
    }
    .case-header .case-desc {
      margin: 0 0 15px;
      font-size: 12px;
      color: var(--text-muted);
    }

    /* 캔버스 영역 */
    .case-canvas {
      min-height: 320px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
      margin-bottom: 15px;
    }
    .case-canvas canvas {
      max-width: 100%;
      height: auto;
    }

    /* 컨트롤 버튼 */
    .case-controls {
      display: flex;
      gap: 8px;
    }
    .case-controls button {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 8px;
      font-family: inherit;
      font-size: 13px;
      cursor: pointer;
      transition: opacity 0.2s;
    }
    .case-controls button:hover {
      opacity: 0.9;
    }
    .btn-config {
      background: var(--btn-config);
      color: #fff;
    }
    .btn-timeline {
      background: var(--primary);
      color: #1a1a2e;
      font-weight: 500;
    }

    /* 상태 표시 */
    .status {
      margin-top: 10px;
      font-size: 11px;
      color: var(--text-muted);
    }
    .status.error {
      color: #ff6b6b;
    }
    .status.success {
      color: var(--primary);
    }

    /* 모달 */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 1000;
    }
    .modal.show {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.7);
    }
    .modal-content {
      position: relative;
      background: var(--card-bg);
      border-radius: 12px;
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      display: flex;
      flex-direction: column;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid #3a3a5a;
    }
    .modal-header h4 {
      margin: 0;
      font-size: 16px;
      color: var(--secondary);
    }
    .modal-close {
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 24px;
      cursor: pointer;
      padding: 0;
      line-height: 1;
    }
    .modal-close:hover {
      color: var(--text);
    }
    .modal-body {
      padding: 20px;
      overflow-y: auto;
      flex: 1;
    }

    /* Config 모달 - JSON */
    .json-view {
      background: var(--bg-dark);
      border-radius: 8px;
      padding: 15px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 12px;
      line-height: 1.5;
      white-space: pre-wrap;
      word-break: break-all;
      color: #a8d8a8;
      max-height: 400px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <!-- 상단 네비게이션 -->
  <nav class="top-nav">
    <a href="../index.html" class="nav-home" title="홈으로">← Hub</a>
    <span class="nav-title">산점도 시각화 케이스</span>
    <span class="nav-version">v2.5.1</span>
  </nav>

  <!-- 헤더 -->
  <header class="page-header">
    <h1>산점도 시각화 케이스</h1>
    <p class="subtitle">상관관계 패턴별 다양한 산점도 케이스 (양의 상관, 음의 상관, 무상관 등)</p>
  </header>

  <!-- 상관관계 패턴 섹션 -->
  <section class="section">
    <h2 class="section-title"><span class="icon">▶</span> 상관관계 패턴</h2>
    <div class="case-grid">

      <!-- S1: 강한 양의 상관 -->
      <div class="case-card" id="case-s1">
        <div class="case-header">
          <h3>S1 - 강한 양의 상관</h3>
          <p class="case-desc">x가 증가하면 y도 증가 (r ≈ 0.9)</p>
        </div>
        <div class="case-canvas" id="canvas-s1"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s1">▶ Timeline</button>
          <button class="btn-config" data-case="s1">{ } Config</button>
        </div>
        <div class="status" id="status-s1"></div>
      </div>

      <!-- S2: 강한 음의 상관 -->
      <div class="case-card" id="case-s2">
        <div class="case-header">
          <h3>S2 - 강한 음의 상관</h3>
          <p class="case-desc">x가 증가하면 y가 감소 (r ≈ -0.9)</p>
        </div>
        <div class="case-canvas" id="canvas-s2"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s2">▶ Timeline</button>
          <button class="btn-config" data-case="s2">{ } Config</button>
        </div>
        <div class="status" id="status-s2"></div>
      </div>

      <!-- S3: 무상관 (원형) -->
      <div class="case-card" id="case-s3">
        <div class="case-header">
          <h3>S3 - 무상관 (원형 분포)</h3>
          <p class="case-desc">상관관계 없음, 원형으로 분포 (r ≈ 0)</p>
        </div>
        <div class="case-canvas" id="canvas-s3"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s3">▶ Timeline</button>
          <button class="btn-config" data-case="s3">{ } Config</button>
        </div>
        <div class="status" id="status-s3"></div>
      </div>

      <!-- S5: 약한 양의 상관 -->
      <div class="case-card" id="case-s5">
        <div class="case-header">
          <h3>S5 - 약한 양의 상관</h3>
          <p class="case-desc">느슨한 양의 관계 (r ≈ 0.4)</p>
        </div>
        <div class="case-canvas" id="canvas-s5"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s5">▶ Timeline</button>
          <button class="btn-config" data-case="s5">{ } Config</button>
        </div>
        <div class="status" id="status-s5"></div>
      </div>

      <!-- S6: 곡선 관계 -->
      <div class="case-card" id="case-s6">
        <div class="case-header">
          <h3>S6 - 비선형 관계</h3>
          <p class="case-desc">곡선 형태의 관계 (2차 함수형)</p>
        </div>
        <div class="case-canvas" id="canvas-s6"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s6">▶ Timeline</button>
          <button class="btn-config" data-case="s6">{ } Config</button>
        </div>
        <div class="status" id="status-s6"></div>
      </div>

    </div>
  </section>

  <!-- 점 강조 섹션 -->
  <section class="section">
    <h2 class="section-title"><span class="icon">▶</span> 점 강조 (pointHighlights)</h2>
    <div class="case-grid">

      <!-- S10: 강조점 1개 -->
      <div class="case-card" id="case-s10">
        <div class="case-header">
          <h3>S10 - 강조점 1개</h3>
          <p class="case-desc">특정 점 하나를 강조 + 라벨</p>
        </div>
        <div class="case-canvas" id="canvas-s10"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s10">▶ Timeline</button>
          <button class="btn-config" data-case="s10">{ } Config</button>
        </div>
        <div class="status" id="status-s10"></div>
      </div>

      <!-- S11: 강조점 2개 -->
      <div class="case-card" id="case-s11">
        <div class="case-header">
          <h3>S11 - 강조점 2개</h3>
          <p class="case-desc">두 점을 다른 색상으로 강조</p>
        </div>
        <div class="case-canvas" id="canvas-s11"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s11">▶ Timeline</button>
          <button class="btn-config" data-case="s11">{ } Config</button>
        </div>
        <div class="status" id="status-s11"></div>
      </div>

      <!-- S12: 강조점 3개 -->
      <div class="case-card" id="case-s12">
        <div class="case-header">
          <h3>S12 - 강조점 3개</h3>
          <p class="case-desc">여러 점을 다양한 스타일로 강조 + 강조점 스케일업 X</p>
        </div>
        <div class="case-canvas" id="canvas-s12"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s12">▶ Timeline</button>
          <button class="btn-config" data-case="s12">{ } Config</button>
        </div>
        <div class="status" id="status-s12"></div>
      </div>

    </div>
  </section>

  <!-- 셀 영역 색칠 섹션 -->
  <section class="section">
    <h2 class="section-title"><span class="icon">▶</span> 셀 영역 색칠 (cellFill)</h2>
    <div class="case-grid">

      <!-- S13: cellFill 좌측 영역 -->
      <div class="case-card" id="case-s13">
        <div class="case-header">
          <h3>S13 - cellFill 좌측 영역</h3>
          <p class="case-desc">가장 많이 나오는 유형</p>
        </div>
        <div class="case-canvas" id="canvas-s13"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s13">▶ Timeline</button>
          <button class="btn-config" data-case="s13">{ } Config</button>
        </div>
        <div class="status" id="status-s13"></div>
      </div>

      <!-- S14: cellFill + 강조점 -->
      <div class="case-card" id="case-s14">
        <div class="case-header">
          <h3>S14 - cellFill + 강조점</h3>
          <p class="case-desc">셀 영역 색칠과 점 강조 조합</p>
        </div>
        <div class="case-canvas" id="canvas-s14"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s14">▶ Timeline</button>
          <button class="btn-config" data-case="s14">{ } Config</button>
        </div>
        <div class="status" id="status-s14"></div>
      </div>

      <!-- S15: cellFill 우상단 영역 -->
      <div class="case-card" id="case-s15">
        <div class="case-header">
          <h3>S15 - cellFill 우상단 영역</h3>
          <p class="case-desc">넓은 범위 셀 영역 색칠</p>
        </div>
        <div class="case-canvas" id="canvas-s15"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s15">▶ Timeline</button>
          <button class="btn-config" data-case="s15">{ } Config</button>
        </div>
        <div class="status" id="status-s15"></div>
      </div>

    </div>
  </section>

  <!-- 직선 (Line) 섹션 -->
  <section class="section">
    <h2 class="section-title"><span class="icon">▶</span> 직선 (line)</h2>
    <div class="case-grid">

      <!-- S16: 직선 기본 -->
      <div class="case-card" id="case-s16">
        <div class="case-header">
          <h3>S16 - 직선 기본</h3>
          <p class="case-desc">기본 대각선 (원점 → 최댓값)</p>
        </div>
        <div class="case-canvas" id="canvas-s16"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s16">▶ Timeline</button>
          <button class="btn-config" data-case="s16">{ } Config</button>
        </div>
        <div class="status" id="status-s16"></div>
      </div>

      <!-- S17: 직선 + 강조점 -->
      <div class="case-card" id="case-s17">
        <div class="case-header">
          <h3>S17 - 직선 + 강조점</h3>
          <p class="case-desc">직선과 점 강조 조합</p>
        </div>
        <div class="case-canvas" id="canvas-s17"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s17">▶ Timeline</button>
          <button class="btn-config" data-case="s17">{ } Config</button>
        </div>
        <div class="status" id="status-s17"></div>
      </div>

      <!-- S18: 직선 + cellFill -->
      <div class="case-card" id="case-s18">
        <div class="case-header">
          <h3>S18 - 직선 + cellFill</h3>
          <p class="case-desc">직선과 셀 색칠 조합</p>
        </div>
        <div class="case-canvas" id="canvas-s18"></div>
        <div class="case-controls">
          <button class="btn-timeline" data-case="s18">▶ Timeline</button>
          <button class="btn-config" data-case="s18">{ } Config</button>
        </div>
        <div class="status" id="status-s18"></div>
      </div>

    </div>
  </section>

  <!-- Corruption 효과 섹션 -->
  <section class="section">
    <h2 class="section-title"><span class="icon">▶</span> Corruption 효과</h2>
    <div class="case-grid">

      <!-- S7: 찢어진 산점도 (Edge) -->
      <div class="case-card" id="case-s7">
        <div class="case-header">
          <h3>S7 - 찢어진 산점도 (Edge)</h3>
          <p class="case-desc">강한 양의 상관 + edgeColor 효과</p>
        </div>
        <div class="case-canvas" id="canvas-s7"></div>
        <div class="case-controls">
          <button class="btn-config" data-case="s7">{ } Config</button>
        </div>
        <div class="status" id="status-s7"></div>
      </div>

      <!-- S8: 찢어진 산점도 (Fiber) -->
      <div class="case-card" id="case-s8">
        <div class="case-header">
          <h3>S8 - 찢어진 산점도 (Fiber)</h3>
          <p class="case-desc">강한 음의 상관 + fiber 효과</p>
        </div>
        <div class="case-canvas" id="canvas-s8"></div>
        <div class="case-controls">
          <button class="btn-config" data-case="s8">{ } Config</button>
        </div>
        <div class="status" id="status-s8"></div>
      </div>

      <!-- S9: 찢어진 산점도 (다중 영역) -->
      <div class="case-card" id="case-s9">
        <div class="case-header">
          <h3>S9 - 찢어진 산점도 (다중 영역)</h3>
          <p class="case-desc">여러 영역에 corruption 적용</p>
        </div>
        <div class="case-canvas" id="canvas-s9"></div>
        <div class="case-controls">
          <button class="btn-config" data-case="s9">{ } Config</button>
        </div>
        <div class="status" id="status-s9"></div>
      </div>

    </div>
  </section>

  <!-- Config 모달 -->
  <div id="config-modal" class="modal">
    <div class="modal-overlay" onclick="closeModal('config-modal')"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h4>Config</h4>
        <button class="modal-close" onclick="closeModal('config-modal')">&times;</button>
      </div>
      <div class="modal-body">
        <div id="config-json" class="json-view"></div>
      </div>
    </div>
  </div>

  <script type="module">
    import * as VizAPI from '../js/viz-api.js';

    // ========================================
    // 데이터 생성 함수들
    // ========================================

    // 강한 양의 상관 데이터 (r ≈ 0.9)
    function generateStrongPositive(n = 50) {
      const data = [];
      for (let i = 0; i < n; i++) {
        const x = 10 + Math.random() * 80;
        const noise = (Math.random() - 0.5) * 15;
        const y = 0.9 * x + 5 + noise;
        data.push([Math.round(x), Math.round(Math.max(5, Math.min(95, y)))]);
      }
      return data;
    }

    // 강한 음의 상관 데이터 (r ≈ -0.9)
    function generateStrongNegative(n = 50) {
      const data = [];
      for (let i = 0; i < n; i++) {
        const x = 10 + Math.random() * 80;
        const noise = (Math.random() - 0.5) * 15;
        const y = 95 - 0.9 * x + noise;
        data.push([Math.round(x), Math.round(Math.max(5, Math.min(95, y)))]);
      }
      return data;
    }

    // 무상관 원형 데이터 (r ≈ 0)
    function generateCircular(n = 50) {
      const data = [];
      const centerX = 50, centerY = 50, radius = 30;
      for (let i = 0; i < n; i++) {
        const angle = Math.random() * Math.PI * 2;
        const r = Math.random() * radius;
        const x = centerX + r * Math.cos(angle);
        const y = centerY + r * Math.sin(angle);
        data.push([Math.round(x), Math.round(y)]);
      }
      return data;
    }

    // 약한 양의 상관 데이터 (r ≈ 0.4)
    function generateWeakPositive(n = 50) {
      const data = [];
      for (let i = 0; i < n; i++) {
        const x = 10 + Math.random() * 80;
        const noise = (Math.random() - 0.5) * 50;
        const y = 0.4 * x + 30 + noise;
        data.push([Math.round(x), Math.round(Math.max(5, Math.min(95, y)))]);
      }
      return data;
    }

    // 비선형 관계 (2차 함수형)
    function generateQuadratic(n = 50) {
      const data = [];
      for (let i = 0; i < n; i++) {
        const x = 10 + Math.random() * 80;
        const noise = (Math.random() - 0.5) * 10;
        // y = -0.02(x-50)^2 + 80 형태 (아래로 볼록)
        const y = -0.025 * Math.pow(x - 50, 2) + 80 + noise;
        data.push([Math.round(x), Math.round(Math.max(10, Math.min(90, y)))]);
      }
      return data;
    }

    // ========================================
    // 케이스 설정
    // ========================================

    const cases = {
      s1: {
        title: 'S1 - 강한 양의 상관',
        desc: 'x가 증가하면 y도 증가 (r ≈ 0.9)',
        config: {
          purpose: 'scatter',
          data: generateStrongPositive(50),
                    options: {
            axisLabels: { xAxis: '용돈(원)', yAxis: '지출액(원)' },
            axis: {
              showYLabels: false,
              showXLabels: false,
              showOriginLabel: false
            },
            grid: {
              showHorizontal: false,
              showVertical: false
            }
          }
        }
      },
      s2: {
        title: 'S2 - 강한 음의 상관',
        desc: 'x가 증가하면 y가 감소 (r ≈ -0.9)',
        config: {
          purpose: 'scatter',
          data: generateStrongNegative(50),
                    options: {
            axisLabels: { xAxis: 'x', yAxis: 'y' },
            axis: {
              showYLabels: false,
              showXLabels: false,
              showOriginLabel: false
            },
            grid: {
              showHorizontal: false,
              showVertical: false
            }
          }
        }
      },
      s3: {
        title: 'S3 - 무상관 (원형 분포)',
        desc: '상관관계 없음, 원형으로 분포 (r ≈ 0)',
        config: {
          purpose: 'scatter',
          data: generateCircular(50),
                    options: {
            axisLabels: { xAxis: 'listen-test', yAxis: 'speak-test' },
            englishFont: true,
            axis: {
              showYLabels: false,
              showXLabels: false,
              showOriginLabel: false
            },
            grid: {
              showHorizontal: false,
              showVertical: false
            }
          }
        }
      },
      s5: {
        title: 'S5 - 약한 양의 상관',
        desc: '느슨한 양의 관계 (r ≈ 0.4)',
        config: {
          purpose: 'scatter',
          data: generateWeakPositive(50),
                    options: {
            axisLabels: { xAxis: 'x', yAxis: 'y' },
            axis: {
              showYLabels: false,
              showXLabels: false,
              showOriginLabel: false
            },
            grid: {
              showHorizontal: false,
              showVertical: false
            }
          }
        }
      },
      s6: {
        title: 'S6 - 비선형 관계',
        desc: '곡선 형태의 관계 (2차 함수형)',
        config: {
          purpose: 'scatter',
          data: generateQuadratic(50),
                    options: {
            axisLabels: { xAxis: 'x', yAxis: 'y' },
            axis: {
              showYLabels: false,
              showXLabels: false,
              showOriginLabel: false
            },
            grid: {
              showHorizontal: false,
              showVertical: false
            }
          }
        }
      },
      s10: {
        title: 'S10 - 강조점 1개',
        desc: '특정 점 하나를 강조 + 라벨',
        config: {
          purpose: 'scatter',
          data: [[4, 5], [5, 2], [5, 5], [5, 6], [6, 5], [7, 6], [7, 7], [7, 8], [8, 6], [8, 7], [8, 9], [8, 10], [9, 7], [9, 8], [10, 7], [10, 10]],
          options: {
            axisLabels: { xAxis: '수행평가 점수', yAxis: '실기 점수' },
            pointSize: 6,
            pointColor: '#93DA6A',
            pointHighlights: [
              { x: 8, y: 10, color: '#008AFF', scale: 2, label: 'A' }
            ]
          }
        }
      },
      s11: {
        title: 'S11 - 강조점 2개',
        desc: '두 점을 다른 색상으로 강조',
        config: {
          purpose: 'scatter',
          data: [[4, 5], [5, 2], [5, 5], [5, 6], [6, 5], [7, 6], [7, 7], [7, 8], [8, 6], [8, 7], [8, 9], [8, 10], [9, 7], [9, 8], [10, 7], [10, 10]],
          options: {
            axisLabels: { xAxis: '수행평가 점수', yAxis: '실기 점수' },
            pointSize: 6,
            pointColor: '#93DA6A',
            pointHighlights: [
              { x: 5, y: 2, color: '#008AFF', scale: 2, label: 'P' },
              { x: 10, y: 10, color: '#E749AF', scale: 2, label: 'Q' }
            ]
          }
        }
      },
      s12: {
        title: 'S12 - 강조점 3개',
        desc: '여러 점을 다양한 스타일로 강조, 강조점 스케일업 X',
        config: {
          purpose: 'scatter',
          data: [[4, 5], [5, 2], [5, 5], [5, 6], [6, 5], [7, 6], [7, 7], [7, 8], [8, 6], [8, 7], [8, 9], [8, 10], [9, 7], [9, 8], [10, 7], [10, 10]],
          options: {
            axisLabels: { xAxis: '수행평가 점수', yAxis: '실기 점수' },
            pointSize: 6,
            pointColor: '#93DA6A',
            pointHighlights: [
              { x: 4, y: 5, color: '#008AFF', scale: 1, label: 'A' },
              { x: 7, y: 7, color: '#E749AF', scale: 1, label: 'B' },
              { x: 10, y: 10, color: '#FF764F', scale: 1, label: 'C' }
            ]
          }
        }
      },
      s13: {
        title: 'S13 - cellFill 기본',
        desc: '기본 셀 영역 색칠',
        config: {
          purpose: 'scatter',
          data: [[50, 50], [60, 70], [70, 60], [80, 80], [90, 90], [100, 100]],
          options: {
            axisLabels: { xAxis: '필기 점수(점)', yAxis: '실기 점수(점)' },
            cellFill: {
              cells: '0-0:2-6'
            }
          }
        }
      },
      s14: {
        title: 'S14 - cellFill + 강조점',
        desc: '셀 영역 색칠과 점 강조 조합',
        config: {
          purpose: 'scatter',
          data: [[50, 50], [60, 70], [70, 60], [80, 80], [90, 90], [100, 100]],
          options: {
            axisLabels: { xAxis: '필기 점수(점)', yAxis: '실기 점수(점)' },
            pointSize: 6,
            pointColor: '#93DA6A',
            cellFill: {
              cells: '1-1:5-5'
            },
            pointHighlights: [
              { x: 100, y: 100, color: '#008AFF', scale: 2, label: 'P' }, { x: 50, y: 50, color: '#E749AF', scale: 2, label: 'Q' }
            ]
          }
        }
      },
      s15: {
        title: 'S15 - cellFill 우상단 영역',
        desc: '넓은 범위 셀 영역 색칠',
        config: {
          purpose: 'scatter',
          data: [[50, 50], [60, 70], [70, 60], [80, 80], [90, 90], [100, 100]],
          options: {
            axisLabels: { xAxis: '필기 점수(점)', yAxis: '실기 점수(점)' },
            cellFill: {
              cells: '4-4:6-6'
            }
          }
        }
      },
      s16: {
        title: 'S16 - 직선 기본',
        desc: '기본 대각선 (원점 → 최댓값)',
        config: {
          purpose: 'scatter',
          data: [[50, 50], [60, 60], [70, 70], [80, 80], [90, 90], [100, 100]],
          options: {
            axisLabels: { xAxis: '필기 점수(점)', yAxis: '실기 점수(점)' },
            line: true
          }
        }
      },
      s17: {
        title: 'S17 - 직선 + 강조점',
        desc: '직선과 점 강조 조합',
        config: {
          purpose: 'scatter',
          data: [[50, 50], [60, 70], [70, 60], [80, 80], [90, 90], [100, 100]],
          options: {
            axisLabels: { xAxis: '필기 점수(점)', yAxis: '실기 점수(점)' },
            pointSize: 6,
            pointColor: '#93DA6A',
            line: true,
            pointHighlights: [
              { x: 100, y: 100, color: '#008AFF', scale: 2, label: 'P' }
            ]
          }
        }
      },
      s18: {
        title: 'S18 - 직선 + cellFill',
        desc: '직선과 셀 색칠 조합',
        config: {
          purpose: 'scatter',
          data: [[50, 50], [60, 70], [70, 60], [80, 80], [90, 90], [100, 100]],
          options: {
            axisLabels: { xAxis: '필기 점수(점)', yAxis: '실기 점수(점)' },
            line: true,
            cellFill: {
              cells: '0-0:2-6'
            }
          }
        }
      },
      s7: {
        title: 'S7 - 찢어진 산점도 (Edge)',
        desc: '강한 양의 상관 + edgeColor 효과',
        config: {
          purpose: 'scatter',
          data: generateStrongPositive(50),
                    options: {
            axisLabels: { xAxis: 'x', yAxis: 'y' },
            corruption: {
              enabled: true,
              cells: '2-5:1-4',
              style: {
                edgeComplexity: 0.8,
                edgeColorEnabled: true,
                edgeColor: 'rgba(136, 136, 136, 1)'
              }
            }
          }
        }
      },
      s8: {
        title: 'S8 - 찢어진 산점도 (Fiber)',
        desc: '강한 음의 상관 + fiber 효과',
        config: {
          purpose: 'scatter',
          data: generateStrongNegative(50),
                    options: {
            axisLabels: { xAxis: 'x', yAxis: 'y' },
            corruption: {
              enabled: true,
              cells: '1-4:2-5',
              style: {
                edgeComplexity: 0.7,
                fiberEnabled: true,
                fiberCount: 25,
                fiberColor: 'rgba(136, 136, 136, 0.8)'
              }
            }
          }
        }
      },
      s9: {
        title: 'S9 - 찢어진 산점도 (다중 영역)',
        desc: '여러 영역에 corruption 적용',
        config: {
          purpose: 'scatter',
          data: [[5, 5], [15, 15], [20, 20], [30, 30], [5, 15], [10, 30], [15, 25], [20, 5], [20, 35], [25, 10], [25, 15], [25, 25], [30, 25], [30, 35], [30, 45], [35, 35], [50, 50]],
          options: {
            axisLabels: { xAxis: '듣기 점수(점)', yAxis: '말하기 점수(점)' },
            pointSize: 7,
            corruption: {
              enabled: true,
              cells: ['4-1:6-2', '5-3:6-3'],
              style: {
                edgeColorEnabled: true
              }
            }
          }
        }
      }
    };

    // 렌더러 저장소
    const renderers = {};

    // 초기화
    async function init() {
      for (const [caseId, caseData] of Object.entries(cases)) {
        const container = document.getElementById(`canvas-${caseId}`);
        const statusEl = document.getElementById(`status-${caseId}`);

        try {
          const result = await VizAPI.renderScatter(container, caseData.config);
          renderers[caseId] = result;

          if (result.error) {
            statusEl.textContent = `Error: ${result.error}`;
            statusEl.classList.add('error');
          } else {
            statusEl.textContent = `렌더링 완료 (${caseData.config.data.length}개 포인트)`;
            statusEl.classList.add('success');
          }
        } catch (error) {
          statusEl.textContent = `Error: ${error.message}`;
          statusEl.classList.add('error');
          console.error(`${caseId} render error:`, error);
        }
      }

      // 버튼 이벤트 바인딩
      bindControlButtons();
    }

    // 컨트롤 버튼 이벤트 바인딩
    function bindControlButtons() {
      // Config 버튼
      document.querySelectorAll('.btn-config').forEach(btn => {
        btn.addEventListener('click', () => {
          const caseId = btn.dataset.case;
          showConfig(caseId);
        });
      });

      // Timeline 버튼
      document.querySelectorAll('.btn-timeline').forEach(btn => {
        btn.addEventListener('click', () => {
          const caseId = btn.dataset.case;
          playTimeline(caseId);
        });
      });
    }

    // Timeline 애니메이션 재생
    function playTimeline(caseId) {
      const renderer = renderers[caseId];
      if (!renderer || !renderer.scatterRenderer) {
        console.error(`No scatterRenderer found for ${caseId}`);
        return;
      }

      const statusEl = document.getElementById(`status-${caseId}`);
      statusEl.textContent = '애니메이션 재생 중...';
      statusEl.classList.remove('error', 'success');

      // 애니메이션 재생
      renderer.scatterRenderer.replayAnimation();

      // 완료 콜백
      const checkComplete = () => {
        if (renderer.timeline.currentTime >= renderer.timeline.duration) {
          statusEl.textContent = `렌더링 완료 (${cases[caseId].config.data.length}개 포인트)`;
          statusEl.classList.add('success');
        } else {
          requestAnimationFrame(checkComplete);
        }
      };
      setTimeout(checkComplete, 100);
    }

    // Config 모달 표시
    function showConfig(caseId) {
      const caseData = cases[caseId];
      const jsonView = document.getElementById('config-json');
      jsonView.textContent = JSON.stringify(caseData.config, null, 2);
      openModal('config-modal');
    }

    // 모달 열기
    function openModal(modalId) {
      document.getElementById(modalId).classList.add('show');
    }

    // 모달 닫기
    window.closeModal = function(modalId) {
      document.getElementById(modalId).classList.remove('show');
    };

    // ESC 키로 모달 닫기
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        document.querySelectorAll('.modal.show').forEach(modal => {
          modal.classList.remove('show');
        });
      }
    });

    // 초기화 실행
    init();
  </script>
</body>
</html>
